<!-- Avatar Upload Component -->
<div class="avatar-upload-container">
    <h3>Avatar Upload</h3>
    <p>Upload your profile picture (max 5MB, images only)</p>

    <!-- Current Avatar Preview -->
    <div {% nitro_if 'avatar_url' %}>
        <div class="avatar-preview">
            <img {% nitro_attr 'src' 'avatar_url' %} alt="Avatar Preview" />
            <div class="avatar-info">
                <p><strong>File:</strong> <span x-text="avatar_name"></span></p>
                <p><strong>Size:</strong> <span x-text="(avatar_size / 1024).toFixed(2)"></span> KB</p>
            </div>
            <button {% nitro_action 'clear_avatar' %} class="btn-danger">
                Clear Avatar
            </button>
        </div>
    </div>

    <!-- Upload Form -->
    <div {% nitro_show '!avatar_url' %}>
        <div class="upload-zone">
            <label for="avatar-input" class="upload-label">
                <svg class="upload-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <span>Click to select an image</span>
            </label>

            <!-- File Input with nitro_file tag -->
            <input
                type="file"
                id="avatar-input"
                {% nitro_file 'avatar' accept='image/*' preview=True max_size='5MB' %}
                style="display: none;"
            />
        </div>

        <!-- Upload Progress (v0.5.0 feature) -->
        <div {% nitro_show 'avatarUploading' %}>
            <div class="progress-bar">
                <div
                    class="progress-fill"
                    :style="'width: ' + avatarUploadProgress + '%'"
                ></div>
            </div>
            <p class="progress-text">
                Uploading: <span x-text="avatarUploadProgress"></span>%
            </p>
        </div>

        <!-- Image Preview (generated by nitro_file with preview=True) -->
        <div {% nitro_show 'avatarPreview' %}>
            <h4>Preview:</h4>
            <img {% nitro_attr 'src' 'avatarPreview' %} alt="Preview" class="preview-image" />
        </div>
    </div>
</div>

<style>
    .avatar-upload-container {
        max-width: 500px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
    }

    .avatar-preview {
        text-align: center;
        margin: 20px 0;
    }

    .avatar-preview img {
        max-width: 200px;
        max-height: 200px;
        border-radius: 50%;
        border: 3px solid #4CAF50;
        margin-bottom: 15px;
    }

    .avatar-info {
        margin: 10px 0;
        font-size: 14px;
    }

    .upload-zone {
        border: 2px dashed #ccc;
        border-radius: 8px;
        padding: 40px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
    }

    .upload-zone:hover {
        border-color: #4CAF50;
        background: #f9f9f9;
    }

    .upload-label {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        cursor: pointer;
    }

    .upload-icon {
        color: #666;
    }

    .progress-bar {
        width: 100%;
        height: 8px;
        background: #eee;
        border-radius: 4px;
        overflow: hidden;
        margin: 15px 0 5px;
    }

    .progress-fill {
        height: 100%;
        background: #4CAF50;
        transition: width 0.3s;
    }

    .progress-text {
        text-align: center;
        font-size: 14px;
        color: #666;
    }

    .preview-image {
        max-width: 200px;
        max-height: 200px;
        border-radius: 8px;
        border: 2px solid #4CAF50;
        margin-top: 10px;
    }

    .btn-danger {
        background: #f44336;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 10px;
    }

    .btn-danger:hover {
        background: #d32f2f;
    }

    .btn-danger:disabled {
        background: #ccc;
        cursor: not-allowed;
    }
</style>
